<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kiran K. Nath">
<meta name="dcterms.date" content="2025-06-27">
<meta name="keywords" content="American Option Pricing, Early Exercise, Boundary Topology, Spectral Collocation, Chebyshev Polynomial Interpolation">

<title>The Antares Spectral Collocation Framework</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Antares_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Antares_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Antares_files/libs/quarto-html/popper.min.js"></script>
<script src="Antares_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Antares_files/libs/quarto-html/anchor.min.js"></script>
<link href="Antares_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Antares_files/libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Antares_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Antares_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Antares_files/libs/bootstrap/bootstrap-076c893dcca4f899fc30a0784f990812.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#mathematical-foundation-and-process-dynamics" id="toc-mathematical-foundation-and-process-dynamics" class="nav-link" data-scroll-target="#mathematical-foundation-and-process-dynamics"><span class="header-section-number">2</span> Mathematical Foundation and Process Dynamics</a></li>
  <li><a href="#the-american-option-valuation-problem" id="toc-the-american-option-valuation-problem" class="nav-link" data-scroll-target="#the-american-option-valuation-problem"><span class="header-section-number">3</span> The American Option Valuation Problem</a></li>
  <li><a href="#integral-equation-formulation" id="toc-integral-equation-formulation" class="nav-link" data-scroll-target="#integral-equation-formulation"><span class="header-section-number">4</span> Integral Equation Formulation</a></li>
  <li><a href="#double-boundary-phenomena-under-negative-interest-rates" id="toc-double-boundary-phenomena-under-negative-interest-rates" class="nav-link" data-scroll-target="#double-boundary-phenomena-under-negative-interest-rates"><span class="header-section-number">5</span> Double Boundary Phenomena Under Negative Interest Rates</a></li>
  <li><a href="#spectral-collocation-methodology" id="toc-spectral-collocation-methodology" class="nav-link" data-scroll-target="#spectral-collocation-methodology"><span class="header-section-number">6</span> Spectral Collocation Methodology</a></li>
  <li><a href="#advanced-numerical-techniques-and-transformations" id="toc-advanced-numerical-techniques-and-transformations" class="nav-link" data-scroll-target="#advanced-numerical-techniques-and-transformations"><span class="header-section-number">7</span> Advanced Numerical Techniques and Transformations</a></li>
  <li><a href="#implementation-architecture-and-computational-optimization" id="toc-implementation-architecture-and-computational-optimization" class="nav-link" data-scroll-target="#implementation-architecture-and-computational-optimization"><span class="header-section-number">8</span> Implementation Architecture and Computational Optimization</a></li>
  <li><a href="#mathematical-validation-and-convergence-analysis" id="toc-mathematical-validation-and-convergence-analysis" class="nav-link" data-scroll-target="#mathematical-validation-and-convergence-analysis"><span class="header-section-number">9</span> Mathematical Validation and Convergence Analysis</a></li>
  <li><a href="#performance-characteristics-and-computational-complexity" id="toc-performance-characteristics-and-computational-complexity" class="nav-link" data-scroll-target="#performance-characteristics-and-computational-complexity"><span class="header-section-number">10</span> Performance Characteristics and Computational Complexity</a></li>
  <li><a href="#extensions-and-future-developments" id="toc-extensions-and-future-developments" class="nav-link" data-scroll-target="#extensions-and-future-developments"><span class="header-section-number">11</span> Extensions and Future Developments</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">12</span> Conclusion</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Antares.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Antares Spectral Collocation Framework</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kiran K. Nath </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 27, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>This paper presents the complete mathematical foundation and implementation methodology of the Antares derivatives pricing engine, a comprehensive computational framework designed for the valuation of American-style options across all interest rate environments. The architecture unifies the treatment of standard single exercise boundary configurations with the complex double-boundary topologies that emerge under negative interest rate conditions through sophisticated spectral collocation techniques. By transforming the classical free-boundary problem into a system of non-linear integral equations for the optimal exercise boundaries, the framework achieves exponential convergence rates while maintaining computational throughput exceeding one hundred thousand option valuations per second. The methodology employs Chebyshev polynomial interpolation on carefully transformed boundary functions, advanced integral equation formulations derived from optimal stopping theory, and accelerated fixed-point iteration schemes that decouple the computation of multiple boundaries. This comprehensive treatment provides both the theoretical foundation and practical implementation details necessary for constructing a production-grade derivatives pricing system capable of handling the full spectrum of market conditions encountered in modern financial environments.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>American Option Pricing, Early Exercise, Boundary Topology, Spectral Collocation, Chebyshev Polynomial Interpolation</p>
  </div>
</div>

</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>The valuation of American-style derivative securities represents one of the most computationally demanding challenges in quantitative finance, primarily due to the optimal stopping feature that introduces a free boundary separating the continuation region from the exercise region. Unlike European options, where analytical solutions exist under the Black-Scholes framework, American options require the simultaneous determination of both the option value and the optimal exercise strategy, creating a coupled problem of considerable mathematical complexity. Traditional numerical approaches, including binomial and trinomial tree methods, finite difference schemes, and Monte Carlo techniques, typically exhibit algebraic convergence rates that necessitate substantial computational resources to achieve high precision results.</p>
<p>The advent of negative interest rates in major global markets has introduced additional mathematical complexities that were not anticipated in classical option pricing theory. Under such conditions, the fundamental assumptions underlying many established pricing methodologies become invalid, potentially leading to exercise regions characterized by two distinct boundaries rather than the single boundary assumed in traditional models. This phenomenon, first rigorously analyzed by Battauz, De Donno, and Sbuelz, creates what is termed a “double continuation region” where the optimal exercise strategy involves exercising the option only when the underlying asset price falls within a specific interval bounded by two time-dependent functions.</p>
<p>The Antares framework addresses these challenges through a unified mathematical architecture that extends the seminal work of Andersen, Lake, and Offengenden on spectral collocation methods for American option pricing. By recasting the free boundary problem as a system of non-linear integral equations and employing sophisticated numerical techniques including Chebyshev polynomial interpolation, high-order quadrature rules, and accelerated fixed-point iterations, the framework achieves spectral convergence rates that dramatically outperform traditional methods. The approach transforms the boundary determination problem through carefully designed mathematical transformations that regularize the solution behavior near the origin, where classical approaches often struggle with convergence.</p>
<p>A particularly significant contribution of this work lies in the development of decoupled iteration schemes for the double-boundary case. Rather than solving a coupled system of equations for both boundaries simultaneously, the mathematical structure of the problem allows for the independent computation of each boundary through separate fixed-point systems. This decoupling not only preserves the computational efficiency of the single-boundary case but also enhances numerical stability and accuracy by avoiding the ill-conditioning that can arise in coupled systems.</p>
<p>The framework incorporates advanced mathematical transformations at multiple levels of the computational hierarchy. The temporal domain undergoes a square-root transformation that concentrates computational effort near the option expiration date where boundary behavior is most critical. The boundary functions themselves are subjected to logarithmic and power transformations that convert highly non-linear functions with unbounded derivatives into nearly linear functions amenable to low-order polynomial approximation. The integral operators are transformed to eliminate weak singularities that would otherwise degrade numerical accuracy, while the iteration schemes employ functional derivatives to achieve quadratic convergence rates.</p>
<p>This comprehensive methodology enables the construction of a production-grade derivatives pricing system that maintains both exceptional accuracy and computational efficiency across the full range of market conditions. The framework handles positive and negative interest rates with equal facility, adapts automatically to single or double boundary topologies based on parameter configurations, and provides machine-precision accuracy for option prices and their sensitivities. The mathematical rigor of the approach ensures robust performance across extreme parameter ranges while the efficient implementation enables real-time applications in risk management and trading systems.</p>
</section>
<section id="mathematical-foundation-and-process-dynamics" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="mathematical-foundation-and-process-dynamics"><span class="header-section-number">2</span> Mathematical Foundation and Process Dynamics</h2>
<p>The mathematical foundation of the Antares framework rests upon the assumption that the underlying asset price follows a geometric Brownian motion under the risk-neutral probability measure. This fundamental modeling choice, while representing a considerable simplification of actual market dynamics, provides the mathematical tractability necessary for developing high-performance computational algorithms while maintaining sufficient realism for practical applications.</p>
<p>Under the risk-neutral measure <span class="math inline">\mathbb{Q}</span>, the asset price process <span class="math inline">S(t)</span> satisfies the stochastic differential equation:</p>
<p><span class="math display">\frac{dS(t)}{S(t)} = (r-q)dt + \sigma dW(t)</span></p>
<p>where the risk-free interest rate <span class="math inline">r</span> captures the time value of money in the economy, the continuous dividend yield <span class="math inline">q</span> represents the income stream generated by the underlying asset, the volatility parameter <span class="math inline">\sigma</span> characterizes the magnitude of random price fluctuations, and <span class="math inline">W(t)</span> denotes a standard Wiener process under the risk-neutral measure. The drift term <span class="math inline">(r-q)</span> emerges naturally from the risk-neutralization process and represents the excess return of the asset over its dividend yield, adjusted to the risk-free rate through the change of measure.</p>
<p>The assumption of constant parameters throughout the option’s lifetime, while restrictive, enables the exploitation of time-homogeneity in the underlying process. This property allows the option value at any time <span class="math inline">t</span> for a contract maturing at time <span class="math inline">T</span> to be expressed as a function of the time to maturity <span class="math inline">\tau \triangleq T-t</span> and the current asset price <span class="math inline">S</span>, independent of the absolute time <span class="math inline">t</span>. This dimensional reduction from a two-dimensional space-time problem to a one-dimensional time-to-maturity problem significantly simplifies both the mathematical analysis and computational implementation.</p>
<p>The geometric Brownian motion assumption implies that the logarithm of the asset price follows a Brownian motion with drift, leading to the familiar lognormal distribution for future asset prices. Specifically, the asset price at time <span class="math inline">t+\tau</span> given the current price <span class="math inline">S</span> follows:</p>
<p><span class="math display">\ln S(t+\tau) \sim \mathcal{N}\left(\ln S + (r-q-\frac{1}{2}\sigma^2)\tau, \sigma^2\tau\right)</span></p>
<p>This distributional property proves essential for the derivation of the integral equations that form the core of the pricing methodology. The parameters <span class="math inline">d_{\pm}(\tau, z)</span> that appear throughout the framework are defined as:</p>
<p><span class="math display">d_{\pm}(\tau, z) \triangleq \frac{\ln(z) + (r-q)\tau \pm \frac{1}{2}\sigma^2\tau}{\sigma\sqrt{\tau}}</span></p>
<p>These quantities represent standardized distances in the lognormal distribution and are fundamental to all option pricing formulas derived from the Black-Scholes framework. The parameter <span class="math inline">d_+</span> corresponds to the “moneyness” of the option adjusted for the time value component, while <span class="math inline">d_-</span> represents the same quantity adjusted for volatility decay.</p>
<p>The mathematical elegance of the geometric Brownian motion framework extends beyond mere computational convenience. The model preserves several economically meaningful properties including the impossibility of negative asset prices, the scale-invariance property that allows option values to depend only on ratios of prices rather than absolute levels, and the time-scaling property that connects options of different maturities through deterministic transformations.</p>
<p>For options on futures contracts, a particularly important special case arises when <span class="math inline">q = r</span>, implying a zero drift in the underlying process. This configuration reflects the martingale property of futures prices under the risk-neutral measure and significantly simplifies many of the computational expressions. In such cases, the asset price process becomes a geometric martingale, and the early exercise premium calculations reduce to more tractable forms.</p>
<p>The framework accommodates negative values of both <span class="math inline">r</span> and <span class="math inline">q</span>, a capability that has become increasingly important in modern financial markets. When <span class="math inline">r &lt; 0</span>, the traditional interpretation of the risk-free rate as the return on a riskless investment requires careful reconsideration, but the mathematical structure of the pricing problem remains well-defined. Similarly, negative dividend yields, which can arise in markets with significant borrowing costs or convenience yields, are naturally incorporated into the framework without requiring special mathematical treatment.</p>
</section>
<section id="the-american-option-valuation-problem" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="the-american-option-valuation-problem"><span class="header-section-number">3</span> The American Option Valuation Problem</h2>
<p>The American option presents a fundamentally different mathematical challenge compared to its European counterpart due to the embedded optimal stopping feature. While European options have a fixed exercise date, American options grant the holder the right to exercise at any time prior to expiration, creating a dynamic optimization problem that must be solved in conjunction with the valuation problem.</p>
<p>Mathematically, the value of an American put option with strike price <span class="math inline">K</span> and maturity <span class="math inline">T</span> at time <span class="math inline">t</span> represents the solution to an optimal stopping problem:</p>
<p><span class="math display">V(\tau, S) = \sup_{\nu \in \mathcal{T}_{t,T}} \mathbb{E}_t^\mathbb{Q} \left[ e^{-r(\nu - t)} (K - S(\nu))^+ \right]</span></p>
<p>where <span class="math inline">\mathcal{T}_{t,T}</span> denotes the set of all stopping times taking values in the interval <span class="math inline">[t,T]</span>, and the supremum is taken over all such admissible exercise strategies. The expectation is computed under the risk-neutral measure <span class="math inline">\mathbb{Q}</span>, ensuring that the discounted option payoff represents the arbitrage-free price in a complete market.</p>
<p>The optimal stopping problem admits a solution characterized by a time-dependent exercise boundary function <span class="math inline">B(\tau)</span> that divides the state space into two regions. The exercise region <span class="math inline">\mathcal{E}(\tau) = \{S : S \leq B(\tau)\}</span> contains all asset price levels at which immediate exercise is optimal, while the continuation region <span class="math inline">\mathcal{C}(\tau) = \{S : S &gt; B(\tau)\}</span> contains all price levels at which holding the option provides greater value than immediate exercise.</p>
<p>The mathematical foundation for this characterization rests upon the theory of optimal stopping for Markov processes. The value function <span class="math inline">V(\tau, S)</span> satisfies the variational inequality:</p>
<p><span class="math display">\max\left\{(K-S)^+, \frac{\partial V}{\partial \tau} + \mathcal{L}V\right\} = 0</span></p>
<p>where <span class="math inline">\mathcal{L}</span> denotes the infinitesimal generator of the asset price process:</p>
<p><span class="math display">\mathcal{L}V = \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + (r-q)S\frac{\partial V}{\partial S} - rV</span></p>
<p>In the continuation region, the variational inequality reduces to the standard Black-Scholes partial differential equation <span class="math inline">\frac{\partial V}{\partial \tau} + \mathcal{L}V = 0</span>, while in the exercise region, the option value equals the intrinsic value <span class="math inline">(K-S)^+</span>.</p>
<p>The exercise boundary <span class="math inline">B(\tau)</span> must satisfy two critical conditions that ensure the optimality of the stopping strategy. The value-matching condition requires that the option value equals the exercise value at the boundary:</p>
<p><span class="math display">V(\tau, B(\tau)) = K - B(\tau)</span></p>
<p>This condition ensures that there is no arbitrage opportunity from exercising at the boundary versus holding the option. The smooth-pasting condition requires that the derivative of the option value with respect to the asset price be continuous at the boundary:</p>
<p><span class="math display">\frac{\partial V}{\partial S}(\tau, B(\tau)) = -1</span></p>
<p>This condition, also known as the high-contact condition, ensures that the exercise boundary represents a true optimum rather than merely a local maximum. Together, these conditions uniquely determine the exercise boundary function.</p>
<p>The mathematical structure of the American option problem exhibits several important properties that the Antares framework exploits for computational efficiency. The value function <span class="math inline">V(\tau, S)</span> is strictly convex in <span class="math inline">S</span> within the continuation region, ensuring that the exercise region forms a connected set. The boundary function <span class="math inline">B(\tau)</span> is continuous for <span class="math inline">\tau &gt; 0</span> and possesses infinite derivatives of all orders at <span class="math inline">\tau = 0</span>, reflecting the singular behavior of the optimal stopping problem near expiration.</p>
<p>For small values of <span class="math inline">\tau</span>, the boundary function approaches a limiting value that depends on the sign relationship between <span class="math inline">r</span> and <span class="math inline">q</span>. When <span class="math inline">r \geq q</span>, the boundary approaches the strike price <span class="math inline">K</span> as <span class="math inline">\tau \to 0^+</span>, while when <span class="math inline">r &lt; q</span>, the boundary approaches <span class="math inline">K(r/q)</span>, creating a jump discontinuity at the origin. This asymptotic behavior plays a crucial role in the design of numerical algorithms, as traditional polynomial approximation methods struggle with the unbounded derivatives near <span class="math inline">\tau = 0</span>.</p>
<p>For large values of <span class="math inline">\tau</span>, the boundary function converges to the perpetual American option boundary, which can be expressed in closed form. For an American put, this limiting value is:</p>
<p><span class="math display">B_\infty = K \frac{\theta_-}{\theta_- - 1}</span></p>
<p>where <span class="math inline">\theta_-</span> represents the negative root of the characteristic equation:</p>
<p><span class="math display">\frac{1}{2}\sigma^2 \theta^2 + (r-q-\frac{1}{2}\sigma^2)\theta - r = 0</span></p>
<p>This long-term behavior provides important boundary conditions for numerical algorithms and serves as a check on the accuracy of computed solutions.</p>
</section>
<section id="integral-equation-formulation" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="integral-equation-formulation"><span class="header-section-number">4</span> Integral Equation Formulation</h2>
<p>The transformation of the American option problem from a partial differential equation with free boundaries to an integral equation represents one of the most significant mathematical innovations in derivatives pricing. This reformulation, originally developed by Kim and later refined by numerous researchers, provides the foundation for highly efficient numerical algorithms while offering deeper insight into the economic structure of the early exercise premium.</p>
<p>The integral equation approach begins with the observation that the American option value can be decomposed into two components: the value of the corresponding European option and an early exercise premium that captures the additional value provided by the flexibility to exercise before expiration. Mathematically, this decomposition takes the form:</p>
<p><span class="math display">V(\tau,S) = v(\tau,S) + \text{Early Exercise Premium}</span></p>
<p>where <span class="math inline">v(\tau,S)</span> represents the European option price given by the Black-Scholes formula:</p>
<p><span class="math display">v(\tau,S) = K e^{-r\tau}\Phi(-d_-(\tau,S/K)) - S e^{-q\tau}\Phi(-d_+(\tau,S/K))</span></p>
<p>The early exercise premium can be derived through a careful application of the fundamental theorem of calculus to the present value of the cash flow stream associated with early exercise. When the option is exercised at any time <span class="math inline">u</span> before expiration, the holder receives the intrinsic value <span class="math inline">K - S(u)</span> but foregoes the remaining time value. The net cash flow at time <span class="math inline">u</span> relative to holding a European option can be expressed as <span class="math inline">(rK - qS(u))du</span>, representing the interest earned on the strike price minus the dividend yield foregone on the short stock position.</p>
<p>The rigorous derivation of the integral equation employs Ito’s lemma applied to the discounted option value process. Consider the process <span class="math inline">H(t) = e^{-rt}V(T-t, S(t))</span> where <span class="math inline">V</span> denotes the American option value. In the continuation region, this process follows:</p>
<p><span class="math display">dH(t) = e^{-rt}\sigma S(t) \frac{\partial V}{\partial S}(T-t, S(t)) dW(t)</span></p>
<p>In the exercise region, however, the process exhibits different behavior due to the immediate exercise of the option. Integrating this stochastic differential equation from time <span class="math inline">t</span> to <span class="math inline">T</span> and taking expectations yields the integral representation.</p>
<p>For the single-boundary case, the complete integral equation takes the form:</p>
<p><span class="math display">V(\tau,S) = v(\tau,S) + \int_{0}^{\tau} rK e^{-r(\tau-u)}\Phi(-d_-(\tau-u,S/B(u)))du - \int_{0}^{\tau} qS e^{-q(\tau-u)}\Phi(-d_+(\tau-u,S/B(u)))du</span></p>
<p>The first integral term represents the present value of the interest earned on the strike price <span class="math inline">K</span> during periods when early exercise is optimal. The integrand <span class="math inline">rK e^{-r(\tau-u)}\Phi(-d_-(\tau-u,S/B(u)))</span> weights the interest flow by the probability that the asset price at time <span class="math inline">T-u</span> falls below the exercise boundary <span class="math inline">B(u)</span>, given the current asset price <span class="math inline">S</span> at time <span class="math inline">T-\tau</span>.</p>
<p>The second integral term captures the present value of the dividend yield foregone on the underlying asset position. The integrand <span class="math inline">qS e^{-q(\tau-u)}\Phi(-d_+(\tau-u,S/B(u)))</span> represents the dividend flow weighted by the same exercise probability, but with the dividend discount factor <span class="math inline">e^{-q(\tau-u)}</span> applied to the current asset price.</p>
<p>The cumulative normal distribution functions <span class="math inline">\Phi(-d_{\pm}(\tau-u,S/B(u)))</span> represent the risk-neutral probabilities that the asset price at time <span class="math inline">T-u</span> falls below the exercise boundary <span class="math inline">B(u)</span>, conditional on the current price <span class="math inline">S</span>. These probabilities arise naturally from the lognormal distribution of future asset prices under the geometric Brownian motion assumption.</p>
<p>The mathematical elegance of this formulation lies in its economic interpretation. The early exercise premium represents the net present value of the cash flow stream generated by the optimal exercise policy. When <span class="math inline">r &gt; q</span>, the interest component dominates, making early exercise more attractive and leading to higher exercise boundaries. Conversely, when <span class="math inline">q &gt; r</span>, the dividend component dominates, making it optimal to delay exercise and collect the dividend stream.</p>
<p>To determine the exercise boundary <span class="math inline">B(\tau)</span>, the integral equation must be combined with the boundary conditions derived from the optimal stopping problem. Applying the value-matching condition <span class="math inline">V(\tau, B(\tau)) = K - B(\tau)</span> to the integral equation yields:</p>
<p><span class="math display">K - B(\tau) = v(\tau, B(\tau)) + \int_{0}^{\tau} rK e^{-r(\tau-u)}\Phi(-d_-(\tau-u,B(\tau)/B(u)))du - \int_{0}^{\tau} qB(\tau) e^{-q(\tau-u)}\Phi(-d_+(\tau-u,B(\tau)/B(u)))du</span></p>
<p>This non-linear integral equation for <span class="math inline">B(\tau)</span> forms the foundation of the numerical algorithm. Alternatively, applying the smooth-pasting condition <span class="math inline">\frac{\partial V}{\partial S}(\tau, B(\tau)) = -1</span> yields a different but equivalent integral equation that often exhibits superior numerical properties.</p>
<p>The mathematical structure of these integral equations reveals several important properties. The kernel functions <span class="math inline">\Phi(-d_{\pm}(\tau-u,B(\tau)/B(u)))</span> are smooth and well-behaved for <span class="math inline">u &lt; \tau</span>, ensuring that standard numerical integration techniques can achieve high accuracy. The dependence of the integrand on the boundary function at different time points creates a Volterra-type integral equation that can be solved iteratively through fixed-point methods.</p>
</section>
<section id="double-boundary-phenomena-under-negative-interest-rates" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="double-boundary-phenomena-under-negative-interest-rates"><span class="header-section-number">5</span> Double Boundary Phenomena Under Negative Interest Rates</h2>
<p>The emergence of negative interest rates in major financial markets has revealed a fascinating mathematical phenomenon that was largely overlooked in classical option pricing theory. Under certain combinations of negative interest rates and dividend yields, the optimal exercise region for American options can assume a qualitatively different topology, characterized by two distinct boundaries rather than the single boundary assumed in traditional models.</p>
<p>This double-boundary phenomenon occurs when the fundamental relationship between the interest component and dividend component of the early exercise premium becomes inverted relative to the standard case. In the traditional setting with positive rates, the exercise region for a put option consists of all asset prices below a single threshold. However, under negative rates, it becomes possible for the exercise region to consist of an interval <span class="math inline">[Y(\tau), B(\tau)]</span> bounded by two time-dependent functions.</p>
<p>For American put options, the double-boundary case arises precisely when <span class="math inline">q &lt; r &lt; 0</span>. The mathematical intuition behind this condition can be understood through the short-maturity analysis of the exercise premium. Just prior to expiration, the decision to exercise depends on the sign of the net carry <span class="math inline">(rK - qS)</span>. For exercise to be optimal, this quantity must be positive, leading to the condition <span class="math inline">S &lt; rK/q</span>. When both <span class="math inline">r</span> and <span class="math inline">q</span> are negative with <span class="math inline">q &lt; r</span>, the ratio <span class="math inline">r/q</span> is positive but less than unity, creating an upper bound on the exercise region at <span class="math inline">rK/q &lt; K</span>.</p>
<p>Simultaneously, the standard lower bound for put option exercise remains at the strike price <span class="math inline">K</span>, since exercising a put option at asset prices above the strike would result in negative intrinsic value. The combination of these effects creates a finite exercise interval <span class="math inline">(rK/q, K)</span> just prior to expiration, with the boundaries potentially moving and potentially intersecting as the time to maturity increases.</p>
<p>The mathematical characterization of the double-boundary region requires a careful analysis of the asymptotic behavior of the boundary functions. As <span class="math inline">\tau \to 0^+</span>, the two boundaries approach the limiting values:</p>
<p><span class="math display">B_0 = \lim_{\tau \to 0^+} B(\tau) = K</span> <span class="math display">Y_0 = \lim_{\tau \to 0^+} Y(\tau) = rK/q</span></p>
<p>The long-term behavior of the boundaries depends critically on the volatility of the underlying asset relative to a critical threshold. Define the critical volatility:</p>
<p><span class="math display">\sigma^* = \left|\sqrt{-2r} - \sqrt{-2q}\right|</span></p>
<p>When the actual volatility exceeds this critical value, <span class="math inline">\sigma &gt; \sigma^*</span>, the two boundaries converge toward each other as the time to maturity increases, eventually intersecting at a finite time <span class="math inline">\tau^*</span>. For maturities beyond this intersection time, the exercise region disappears entirely, and the American option becomes equivalent to its European counterpart.</p>
<p>When the volatility falls below the critical threshold, <span class="math inline">\sigma &lt; \sigma^*</span>, the boundaries never intersect and instead converge to distinct finite limits as <span class="math inline">\tau \to \infty</span>. These limiting values can be expressed in terms of the roots of the characteristic equation:</p>
<p><span class="math display">B_\infty = K \frac{\lambda_+}{\lambda_+ - 1}, \quad Y_\infty = K \frac{\lambda_-}{\lambda_- - 1}</span></p>
<p>where <span class="math inline">\lambda_{\pm}</span> represent the positive and negative roots:</p>
<p><span class="math display">\lambda_{\pm} = \frac{-\mu \pm \sqrt{\mu^2 + 2r\sigma^2}}{\sigma^2}, \quad \mu = r - q - \frac{\sigma^2}{2}</span></p>
<p>The boundary case <span class="math inline">\sigma = \sigma^*</span> results in the boundaries converging to the same limit <span class="math inline">B_\infty = Y_\infty = K\sqrt{r/q}</span>.</p>
<p>The integral equation formulation must be extended to accommodate the double-boundary topology. The early exercise premium now involves integration over the finite exercise region rather than the semi-infinite region of the single-boundary case. The complete integral equation for the double-boundary American put takes the form:</p>
<p><span class="math display">V(\tau,S,K) = p(\tau,S,K) + rK\int_{0}^{\min(\tau,\tau^{*})}[p_{K}(\tau-u,S,B(u))-p_{K}(\tau-u,S,Y(u))]du + qS\int_{0}^{\min(\tau,\tau^{*})}[p_{S}(\tau-u,S,B(u))-p_{S}(\tau-u,S,Y(u))]du</span></p>
<p>where <span class="math inline">p_K</span> and <span class="math inline">p_S</span> denote the partial derivatives of the European put price with respect to the strike and spot price, respectively. The upper limit of integration reflects the finite lifetime of the exercise region when the boundaries intersect.</p>
<p>The mathematical structure of this equation reveals a remarkable property that proves crucial for efficient numerical implementation. Despite the apparent coupling between the two boundaries in the integral equation, the boundary conditions can be manipulated to yield two decoupled systems that allow each boundary to be computed independently.</p>
<p>For the upper boundary <span class="math inline">B(\tau)</span>, applying the value-matching condition at asset prices above the exercise region yields a fixed-point equation that depends only on <span class="math inline">B</span> and not on <span class="math inline">Y</span>. Similarly, for the lower boundary <span class="math inline">Y(\tau)</span>, applying the smooth-pasting condition at asset prices below the exercise region yields a fixed-point equation that depends only on <span class="math inline">Y</span> and not on <span class="math inline">B</span>.</p>
<p>This decoupling property dramatically simplifies the computational problem, allowing the two boundaries to be computed through separate iterations rather than solving a coupled system. The mathematical basis for this decoupling lies in the principle that for asset prices outside the exercise interval, the option value depends only on the boundary that would be encountered first by the diffusion process.</p>
</section>
<section id="spectral-collocation-methodology" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="spectral-collocation-methodology"><span class="header-section-number">6</span> Spectral Collocation Methodology</h2>
<p>The numerical solution of the integral equations governing American option pricing presents significant computational challenges due to the non-linear and non-local nature of the problem. Traditional approaches such as finite difference methods or simple quadrature schemes typically exhibit algebraic convergence rates, requiring substantial computational resources to achieve high precision. The Antares framework addresses these challenges through a sophisticated spectral collocation methodology that achieves exponential convergence rates while maintaining computational efficiency.</p>
<p>The foundation of the spectral approach lies in the representation of the unknown boundary function through high-order polynomial approximation. Rather than discretizing the entire time domain with a fine grid, the method solves the integral equation at a small number of carefully chosen collocation points and represents the solution between these points through polynomial interpolation. This approach exploits the smoothness of the boundary function away from the origin to achieve high accuracy with minimal computational effort.</p>
<p>The selection of collocation points follows Chebyshev polynomial theory, which provides near-optimal point distributions for polynomial approximation. The Chebyshev nodes on the interval <span class="math inline">[0, \sqrt{\tau_{\max}}]</span> are given by:</p>
<p><span class="math display">x_i = \frac{\sqrt{\tau_{\max}}}{2}\left(1 + \cos\left(\frac{i\pi}{n}\right)\right), \quad i = 0, 1, \ldots, n</span></p>
<p>where <span class="math inline">n</span> represents the number of collocation points and <span class="math inline">\tau_{\max}</span> denotes the maximum time to maturity for which the boundary must be computed. The corresponding time points are <span class="math inline">\tau_i = x_i^2</span>, reflecting the square-root transformation that concentrates computational effort near the critical region around expiration.</p>
<p>The choice of Chebyshev nodes is motivated by their optimal properties for polynomial interpolation. Unlike equidistant point distributions, which can lead to the Runge phenomenon and oscillatory interpolation errors, Chebyshev nodes minimize the maximum interpolation error and provide stable high-order polynomial approximation. The resulting interpolation error decreases exponentially with the number of points for sufficiently smooth functions.</p>
<p>However, the raw exercise boundary function <span class="math inline">B(\tau)</span> is not well-suited for direct polynomial approximation due to its singular behavior near <span class="math inline">\tau = 0</span>. The boundary exhibits unbounded derivatives of all orders at the origin, making direct polynomial approximation inefficient. To overcome this limitation, the Antares framework employs a sophisticated transformation that regularizes the boundary function and enables efficient polynomial representation.</p>
<p>The transformation proceeds in several stages, each designed to improve the smoothness and polynomial approximability of the resulting function. First, the boundary is normalized by its short-maturity limiting value:</p>
<p><span class="math display">\widetilde{B}(\tau) = \frac{B(\tau)}{X}, \quad X = K \min(1, r/q)</span></p>
<p>This normalization removes the dependence on the strike price and adjusts for the discontinuity that occurs when <span class="math inline">r &lt; q</span>. Next, a logarithmic transformation is applied to linearize the exponential decay behavior:</p>
<p><span class="math display">G(\sqrt{\tau}) = \ln(\widetilde{B}(\tau))</span></p>
<p>Finally, a variance-stabilizing transformation converts the function to a nearly linear form:</p>
<p><span class="math display">H(\sqrt{\tau}) = G(\sqrt{\tau})^2 = \ln(\widetilde{B}(\tau))^2</span></p>
<p>This final function <span class="math inline">H(x)</span> with <span class="math inline">x = \sqrt{\tau}</span> exhibits remarkable smoothness and near-linearity, making it ideally suited for low-order polynomial approximation. The transformation effectively converts a highly non-linear function with singular derivatives into a function that can be accurately represented by polynomials of degree five or less.</p>
<p>The polynomial interpolation of the transformed function follows the Chebyshev interpolation formula. Given function values <span class="math inline">H_i = H(x_i)</span> at the Chebyshev nodes, the interpolating polynomial can be expressed as:</p>
<p><span class="math display">H_C(x) = \sum_{k=0}^{n} a_k T_k\left(\frac{2x}{\sqrt{\tau_{\max}}} - 1\right)</span></p>
<p>where <span class="math inline">T_k</span> denotes the <span class="math inline">k</span>-th Chebyshev polynomial of the first kind and the coefficients <span class="math inline">a_k</span> are computed through the discrete cosine transform:</p>
<p><span class="math display">a_k = \frac{2}{n}\left[\frac{1}{2}H_0 + \sum_{j=1}^{n-1} H_j \cos\left(\frac{jk\pi}{n}\right) + \frac{(-1)^k}{2}H_n\right]</span></p>
<p>The evaluation of the interpolating polynomial at arbitrary points employs the numerically stable Clenshaw recurrence algorithm, which avoids the potential instabilities associated with direct polynomial evaluation.</p>
<p>The accuracy of the spectral collocation approach depends critically on the smoothness of the transformed boundary function. The mathematical analysis of the transformation reveals that <span class="math inline">H(x)</span> is infinitely differentiable for <span class="math inline">x &gt; 0</span> and exhibits polynomial growth in its derivatives, ensuring exponential convergence of the Chebyshev approximation. Empirical testing confirms that five to seven collocation points typically suffice to achieve relative errors below <span class="math inline">10^{-6}</span> for most practical parameter ranges.</p>
<p>The efficiency of the spectral method extends beyond the boundary representation to the evaluation of the integral operators that appear in the fixed-point equations. The smooth nature of the transformed boundary enables the use of high-order quadrature rules that achieve exponential convergence with minimal function evaluations. The method employs Gauss-Legendre quadrature for smooth integrands and tanh-sinh quadrature for integrands with endpoint singularities.</p>
</section>
<section id="advanced-numerical-techniques-and-transformations" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="advanced-numerical-techniques-and-transformations"><span class="header-section-number">7</span> Advanced Numerical Techniques and Transformations</h2>
<p>The exceptional performance of the Antares framework derives not only from the spectral collocation approach but also from a suite of advanced numerical techniques that address the specific mathematical challenges arising in American option pricing. These techniques include sophisticated transformations for handling integral singularities, accelerated iteration schemes for rapid convergence, and adaptive algorithms that automatically adjust computational parameters based on problem characteristics.</p>
<p>The integral operators that appear in the fixed-point equations often contain weak singularities that can degrade the accuracy of standard numerical integration methods. Specifically, the smooth-pasting formulation (System A) includes integrals of the form:</p>
<p><span class="math display">\mathcal{K}_2(\tau) = \int_{0}^{\tau} \frac{e^{qu}}{\sigma\sqrt{\tau-u}} \phi(d_+(\tau-u, B(\tau)/B(u))) du</span></p>
<p>The factor <span class="math inline">(\tau-u)^{-1/2}</span> creates a weak singularity at <span class="math inline">u = \tau</span> that requires special treatment to maintain numerical accuracy. The Antares framework addresses this challenge through an analytical transformation that eliminates the singularity while preserving the smooth structure of the integrand.</p>
<p>The transformation employs the substitution <span class="math inline">z = \sqrt{\tau - u}</span>, which yields <span class="math inline">du = -2z \, dz</span> and transforms the integral to:</p>
<p><span class="math display">\mathcal{K}_2(\tau) = 2\int_{0}^{\sqrt{\tau}} \frac{e^{q(\tau-z^2)}}{\sigma} \phi(d_+(z^2, B(\tau)/B(\tau-z^2))) z \, dz</span></p>
<p>This transformation completely eliminates the singularity, replacing it with a smooth integrand that can be evaluated accurately using standard high-order quadrature rules. The additional factor of <span class="math inline">z</span> in the integrand ensures that the transformed integral remains well-behaved at <span class="math inline">z = 0</span>.</p>
<p>For computational efficiency, the integration domain is further transformed to the standard interval <span class="math inline">[-1, 1]</span> through the substitution:</p>
<p><span class="math display">y = -1 + \frac{2z}{\sqrt{\tau}} = -1 + 2\sqrt{\frac{\tau-u}{\tau}}</span></p>
<p>This normalization enables the use of standard Gaussian quadrature weights and nodes, avoiding the need to recompute quadrature parameters for each value of <span class="math inline">\tau</span>. The final transformed integral takes the form:</p>
<p><span class="math display">\mathcal{K}_2(\tau) = \frac{e^{q\tau}\sqrt{\tau}}{\sigma} \int_{-1}^{1} e^{-\frac{q\tau(1+y)^2}{4}} (1+y) \phi\left(d_+\left(\frac{\tau(1+y)^2}{4}, \frac{B(\tau)}{B(\tau-\frac{\tau(1+y)^2}{4})}\right)\right) dy</span></p>
<p>The convergence rate of the fixed-point iteration can be significantly enhanced through the use of accelerated iteration schemes that exploit the mathematical structure of the problem. The standard fixed-point iteration <span class="math inline">B^{(j)} = F(B^{(j-1)})</span> typically exhibits linear convergence, requiring numerous iterations to achieve high precision. The Antares framework employs a modified Jacobi-Newton scheme that achieves quadratic convergence by incorporating information about the functional derivative of the mapping <span class="math inline">F</span>.</p>
<p>The Jacobi-Newton iteration takes the form:</p>
<p><span class="math display">B^{(j)}(\tau) = B^{(j-1)}(\tau) + \eta \frac{B^{(j-1)}(\tau) - F(\tau, B^{(j-1)})}{F'(\tau, B^{(j-1)}) - 1}</span></p>
<p>where <span class="math inline">F'(\tau, B)</span> denotes the Gateaux derivative of the fixed-point mapping with respect to perturbations in <span class="math inline">B(\tau)</span>, and <span class="math inline">\eta</span> is a relaxation parameter that ensures stability. The computation of the functional derivative requires additional integral evaluations but typically reduces the number of required iterations from dozens to fewer than five.</p>
<p>For the double-boundary case, the decoupled nature of the iteration systems enables the use of different acceleration strategies for each boundary. The upper boundary <span class="math inline">B(\tau)</span>, which typically exhibits more non-linear behavior, benefits from the full Jacobi-Newton acceleration. The lower boundary <span class="math inline">Y(\tau)</span>, which tends to be smoother and more linear, can often be computed accurately with simplified acceleration schemes or even standard fixed-point iteration.</p>
<p>The initialization of the iteration scheme plays a crucial role in determining both the convergence rate and the overall computational efficiency. Poor initial guesses can lead to slow convergence or even divergence, particularly in challenging parameter regimes. The Antares framework employs sophisticated analytical approximations to provide high-quality initial boundary estimates.</p>
<p>For the single-boundary case, the framework uses the QD+ approximation method, which provides analytical expressions for the boundary based on refined asymptotic analysis. This method typically yields initial guesses accurate to within one percent of the true boundary value, significantly reducing the number of required iterations.</p>
<p>For the double-boundary case, the initialization process is more complex due to the need to provide estimates for both boundaries. The framework employs a combination of asymptotic analysis near expiration and perpetual option theory for long maturities. The short-maturity estimates use the exact limiting values <span class="math inline">B_0 = K</span> and <span class="math inline">Y_0 = rK/q</span>, while the long-maturity estimates employ the perpetual option formulas when they exist.</p>
<p>In cases where the boundaries intersect, the framework includes algorithms for detecting and accurately computing the intersection time <span class="math inline">\tau^*</span>. This computation is performed through a combination of interval bisection and higher-order root-finding methods applied to the equation <span class="math inline">B(\tau^*) = Y(\tau^*)</span>. The accurate determination of <span class="math inline">\tau^*</span> is crucial for the correct evaluation of the option price integral, as the integration domain depends on whether the current time to maturity exceeds the intersection time.</p>
</section>
<section id="implementation-architecture-and-computational-optimization" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="implementation-architecture-and-computational-optimization"><span class="header-section-number">8</span> Implementation Architecture and Computational Optimization</h2>
<p>The translation of the mathematical framework into a high-performance computational system requires careful attention to algorithmic efficiency, numerical stability, and software architecture. The Antares implementation employs a modular design that separates the mathematical algorithms from the computational infrastructure, enabling both flexibility in method selection and optimization for specific hardware architectures.</p>
<p>The core computational workflow follows a hierarchical structure that minimizes redundant calculations while maximizing numerical accuracy. At the highest level, the system determines the appropriate mathematical formulation based on the input parameters, automatically selecting between single-boundary and double-boundary methodologies based on the signs and magnitudes of the interest rate and dividend yield.</p>
<p>For American call options, the framework exploits the fundamental put-call symmetry relationship to avoid duplicating the mathematical development. The symmetry transformation maps a call option with parameters <span class="math inline">(S, K, r, q, \sigma, \tau)</span> to a put option with parameters <span class="math inline">(K, S, q, r, \sigma, \tau)</span>. This transformation not only reduces the codebase complexity but also ensures that all optimizations and accuracy improvements benefit both put and call valuations equally.</p>
<p>The boundary computation algorithm employs adaptive parameter selection to optimize the trade-off between accuracy and computational speed. The number of collocation points <span class="math inline">n</span> is automatically adjusted based on the problem characteristics, with additional points added in regions where the boundary exhibits rapid variation. Similarly, the number of quadrature points <span class="math inline">l</span> for integral evaluation is selected based on the required accuracy and the smoothness of the integrand.</p>
<p>The fixed-point iteration process incorporates multiple convergence criteria to ensure robust termination. The primary criterion monitors the maximum relative change in the boundary function between successive iterations, while secondary criteria check for oscillatory behavior and excessively slow convergence. The iteration process terminates when either high accuracy is achieved or when additional iterations are unlikely to improve the solution significantly.</p>
<p>Memory management plays a crucial role in the efficiency of the spectral collocation approach. The framework employs sophisticated caching strategies that store intermediate results for reuse across multiple option valuations. When pricing multiple options with identical model parameters but different spot prices or strikes, the exercise boundary computation is performed only once, with the boundary function cached for subsequent price calculations.</p>
<p>The numerical integration routines are optimized for the specific structure of the option pricing integrands. The framework includes specialized implementations of Gauss-Legendre quadrature for smooth integrands and tanh-sinh quadrature for integrands with endpoint singularities or rapid oscillations. The quadrature weights and nodes are precomputed and stored in lookup tables to eliminate redundant calculations.</p>
<p>For the double-boundary case, the framework includes sophisticated algorithms for handling the intersection detection and boundary coupling. The system monitors the relative positions of the two boundaries throughout the computation and automatically switches to simplified single-boundary calculations when the boundaries become sufficiently close. This adaptive approach maintains accuracy while avoiding numerical difficulties that can arise when the exercise region becomes very narrow.</p>
<p>Error estimation and adaptive refinement provide additional layers of computational robustness. The framework includes built-in error estimates based on Richardson extrapolation and comparison with lower-order approximations. When the estimated error exceeds user-specified tolerances, the system automatically increases the number of collocation points or quadrature nodes and recomputes the solution.</p>
<p>The implementation includes extensive validation and testing infrastructure to ensure numerical accuracy across the full range of supported parameter values. The validation suite includes comparisons with analytical solutions for limiting cases, cross-validation between different numerical formulations, and convergence studies that verify the expected exponential convergence rates.</p>
<p>Parallel computation capabilities enable the framework to exploit modern multi-core processor architectures. The boundary computation algorithms are naturally parallel, as the fixed-point equations at different time points can be evaluated independently. Similarly, the computation of multiple option prices with common boundary functions can be distributed across multiple processing cores.</p>
<p>The software architecture emphasizes modularity and extensibility to facilitate future enhancements and customizations. The mathematical algorithms are encapsulated in self-contained modules with well-defined interfaces, enabling easy modification of specific components without affecting the overall system. This design facilitates the incorporation of alternative mathematical formulations, experimental algorithms, and specialized optimizations for particular market segments.</p>
</section>
<section id="mathematical-validation-and-convergence-analysis" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="mathematical-validation-and-convergence-analysis"><span class="header-section-number">9</span> Mathematical Validation and Convergence Analysis</h2>
<p>The rigorous validation of the Antares framework requires comprehensive mathematical analysis of convergence properties, error bounds, and numerical stability across the full range of supported parameter values. This analysis combines theoretical convergence results from spectral approximation theory with extensive empirical testing using both synthetic benchmarks and market data.</p>
<p>The theoretical foundation for the exponential convergence of the spectral collocation method rests upon the smoothness properties of the transformed boundary function. The mathematical analysis demonstrates that the function <span class="math inline">H(x) = \ln(B(x^2)/X)^2</span> possesses bounded derivatives of all orders for <span class="math inline">x &gt; 0</span>, with derivative bounds that grow at most polynomially with the order. This regularity ensures that the Chebyshev polynomial approximation converges exponentially fast as the number of collocation points increases.</p>
<p>Specifically, for the transformed boundary function <span class="math inline">H(x)</span>, the approximation error satisfies the bound:</p>
<p><span class="math display">\|H - H_n\|_{\infty} \leq C \rho^{-n}</span></p>
<p>where <span class="math inline">H_n</span> denotes the <span class="math inline">n</span>-point Chebyshev interpolant, <span class="math inline">C</span> is a constant depending on the function smoothness, and <span class="math inline">\rho &gt; 1</span> is the convergence rate parameter. The parameter <span class="math inline">\rho</span> is determined by the location of the nearest singularity of <span class="math inline">H</span> in the complex plane, with larger values of <span class="math inline">\rho</span> corresponding to faster convergence.</p>
<p>Empirical convergence studies confirm the theoretical predictions across a wide range of parameter values. For typical market parameters, the relative error in the boundary function decreases by approximately one order of magnitude for each additional collocation point, achieving machine precision with fewer than ten points. This exponential convergence dramatically outperforms traditional finite difference methods, which typically require hundreds or thousands of grid points to achieve comparable accuracy.</p>
<p>The convergence analysis extends to the option price calculations, which depend on the accuracy of both the boundary computation and the final price integral. The error in the option price can be decomposed into three components: boundary approximation error, integral approximation error, and iteration truncation error. The boundary approximation error inherits the exponential convergence of the spectral method, while the integral approximation error is controlled through high-order quadrature rules.</p>
<p>The iteration truncation error, arising from the finite number of fixed-point iterations, typically converges linearly for standard fixed-point schemes and quadratically for the accelerated Jacobi-Newton method. The framework monitors this error component through successive approximation differences and terminates the iteration when the improvement becomes negligible relative to other error sources.</p>
<p>Stability analysis focuses on the robustness of the numerical algorithms under parameter perturbations and computational round-off errors. The condition number of the spectral collocation system remains well-bounded for typical parameter ranges, ensuring that small perturbations in the input data do not lead to large changes in the computed results. The Chebyshev node distribution provides inherent stability advantages over other point distributions, avoiding the oscillatory instabilities that can plague high-order polynomial methods.</p>
<p>For the double-boundary case, additional validation focuses on the accuracy of the intersection time computation and the behavior of the algorithm near the critical volatility <span class="math inline">\sigma^*</span>. The framework includes specialized tests for parameter combinations that result in boundaries that nearly intersect, as these cases present the greatest numerical challenges. The results demonstrate that the method maintains accuracy even when the exercise region becomes very narrow.</p>
<p>Benchmark comparisons with alternative numerical methods provide empirical validation of the framework’s accuracy and efficiency claims. The framework is tested against high-precision finite difference solutions, Monte Carlo methods with variance reduction techniques, and other state-of-the-art American option pricing algorithms. These comparisons consistently demonstrate superior accuracy-to-cost ratios for the spectral approach.</p>
<p>The validation suite includes extensive testing with extreme parameter values that stress the numerical algorithms. These tests encompass very short and very long maturities, extremely high and low volatilities, and interest rate configurations that span both positive and negative values. The framework demonstrates robust performance across this entire parameter space, maintaining accuracy and stability even in challenging regimes.</p>
<p>Error estimation capabilities enable real-time assessment of solution quality without requiring expensive benchmark computations. The framework employs multiple error indicators, including Richardson extrapolation estimates based on solutions with different numbers of collocation points, iteration residual monitoring, and comparison with asymptotic formulas in limiting cases.</p>
</section>
<section id="performance-characteristics-and-computational-complexity" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="performance-characteristics-and-computational-complexity"><span class="header-section-number">10</span> Performance Characteristics and Computational Complexity</h2>
<p>The computational performance of the Antares framework represents a significant advancement over traditional American option pricing methods, achieving execution speeds that enable real-time portfolio valuation while maintaining exceptional numerical accuracy. The performance characteristics result from the synergistic combination of mathematical innovations and computational optimizations embedded throughout the framework architecture.</p>
<p>The asymptotic computational complexity of the spectral collocation method scales as <span class="math inline">O(mn^2 + lmn)</span>, where <span class="math inline">m</span> denotes the number of fixed-point iterations, <span class="math inline">n</span> represents the number of collocation points, and <span class="math inline">l</span> indicates the number of quadrature points. This scaling behavior compares favorably with finite difference methods, which typically scale as <span class="math inline">O(N_t N_s)</span> where <span class="math inline">N_t</span> and <span class="math inline">N_s</span> represent the number of time and space grid points, respectively.</p>
<p>The key computational advantage stems from the ability to achieve high accuracy with very small values of the controlling parameters. Typical calculations require <span class="math inline">n \leq 8</span> collocation points, <span class="math inline">m \leq 6</span> fixed-point iterations, and <span class="math inline">l \leq 16</span> quadrature points, resulting in total operation counts of fewer than one thousand floating-point operations per option valuation. This efficiency enables computational throughputs exceeding 100,000 option prices per second on modern processor architectures.</p>
<p>The boundary representation through Chebyshev polynomial interpolation provides additional computational benefits beyond the low-order approximation capability. The evaluation of the interpolated boundary at arbitrary points requires only <span class="math inline">O(n)</span> operations using the Clenshaw recurrence algorithm, enabling efficient computation of the integrals that appear in the price formulas. Moreover, the polynomial representation facilitates the analytical computation of boundary derivatives needed for Greeks calculations.</p>
<p>Memory requirements of the framework remain modest due to the compact representation of the solution. The complete boundary function is captured by fewer than ten polynomial coefficients, resulting in memory footprints measured in kilobytes rather than megabytes. This efficiency enables the concurrent pricing of large option portfolios without memory constraints.</p>
<p>The double-boundary case introduces additional computational considerations due to the need to compute two boundary functions and detect their potential intersection. However, the decoupled iteration scheme ensures that the computational complexity scales linearly with the number of boundaries rather than exponentially as might be expected for coupled systems. The intersection detection algorithm adds minimal overhead, typically requiring fewer than ten function evaluations to achieve high precision.</p>
<p>Parallel computation capabilities further enhance the performance characteristics by exploiting the natural parallelism inherent in the mathematical algorithms. The boundary computations at different time points are independent and can be distributed across multiple processor cores. Similarly, portfolio pricing applications can parallelize over individual option contracts, achieving near-linear speedup with the number of available cores.</p>
<p>The framework’s performance scales gracefully with problem difficulty, automatically adapting computational effort to achieve user-specified accuracy targets. For simple cases with moderate parameter values, the method achieves high accuracy with minimal computational effort. For challenging cases involving extreme parameters or high precision requirements, the adaptive algorithms increase the computational resources proportionally to maintain accuracy standards.</p>
<p>Cache efficiency plays an important role in the practical performance of the framework. The compact data structures and regular memory access patterns optimize processor cache utilization, while the polynomial representation enables efficient vectorization of computational kernels on modern SIMD processor architectures.</p>
<p>Profiling analysis reveals that the computational effort is distributed relatively evenly across the major algorithmic components. Approximately forty percent of the execution time is devoted to integral evaluation, thirty percent to polynomial interpolation and evaluation, twenty percent to convergence monitoring and control logic, and ten percent to initialization and setup costs. This balanced distribution indicates that no single component dominates the computational cost, suggesting that the overall algorithm design is well-optimized.</p>
<p>The performance characteristics remain stable across different market conditions and parameter regimes. Unlike some alternative methods that exhibit degraded performance for certain parameter combinations, the spectral approach maintains consistent execution times and accuracy levels. This stability is particularly important for risk management applications that require reliable performance under stressed market conditions.</p>
<p>Comparison with other high-performance American option pricing methods demonstrates the competitive advantages of the spectral approach. The framework typically achieves accuracy comparable to finite difference methods with thousands of grid points while executing in a fraction of the computational time. Similarly, the method provides deterministic results with guaranteed accuracy bounds, unlike Monte Carlo approaches that provide only statistical estimates with confidence intervals.</p>
</section>
<section id="extensions-and-future-developments" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="extensions-and-future-developments"><span class="header-section-number">11</span> Extensions and Future Developments</h2>
<p>The mathematical foundation of the Antares framework provides a robust platform for numerous extensions and enhancements that can address additional market segments and computational challenges. The spectral collocation methodology generalizes naturally to more complex derivative structures, alternative underlying process models, and advanced risk management applications.</p>
<p>The extension to time-dependent parameters represents a natural progression that addresses the limitations of the constant parameter assumption. Many practical applications require the incorporation of term structures for interest rates, dividend yields, and volatilities. The mathematical framework can accommodate such extensions through modifications to the integral equation formulation and the introduction of time-dependent transformation functions.</p>
<p>For time-dependent interest rates <span class="math inline">r(t)</span> and dividend yields <span class="math inline">q(t)</span>, the integral equation takes the modified form:</p>
<p><span class="math display">V(\tau,S) = v(\tau,S) + \int_{0}^{\tau} r(T-u)K e^{-\int_{T-\tau}^{T-u} r(s)ds}\Phi(-d_-(u,S/B(u),T-\tau))du - \int_{0}^{\tau} q(T-u)S e^{-\int_{T-\tau}^{T-u} q(s)ds}\Phi(-d_+(u,S/B(u),T-\tau))du</span></p>
<p>where the exponential discount factors are replaced by integrals of the time-dependent rates. The boundary computation algorithms require only minor modifications to accommodate these changes, with the primary impact being increased computational cost due to the evaluation of the time integrals.</p>
<p>The incorporation of stochastic volatility models, such as the Heston model, presents greater mathematical challenges but remains within the scope of the framework. The exercise boundary becomes a function of both time and the volatility state variable, requiring a two-dimensional representation. However, the fundamental spectral approach can be extended through tensor product constructions and multi-dimensional interpolation schemes.</p>
<p>Jump-diffusion models represent another important extension that addresses the limitations of the pure diffusion assumption. The presence of jumps modifies the integral equation through additional terms that capture the contribution of large price movements that cross the exercise boundary. While this extension increases the mathematical complexity, the spectral framework provides a natural foundation for handling the additional integral terms.</p>
<p>The framework’s architecture facilitates the incorporation of alternative exercise styles and exotic features. Bermudan options, which permit exercise only at discrete dates, can be handled through modifications of the integral equation that restrict the exercise region to specific time points. Barrier features can be incorporated through additional boundary conditions and constraint equations.</p>
<p>Advanced Greeks calculation represents an area where the spectral approach provides significant advantages over traditional methods. The polynomial representation of the boundary function enables analytical differentiation with respect to model parameters, providing exact expressions for price sensitivities. These capabilities are particularly valuable for risk management applications that require accurate and stable Greeks calculations.</p>
<p>The extension to multi-asset options, such as basket options or exchange options, follows naturally from the single-asset framework. The exercise boundary becomes a hypersurface in the multi-dimensional asset price space, requiring advanced interpolation techniques and higher-dimensional quadrature rules. However, the fundamental mathematical principles remain applicable.</p>
<p>Model calibration and inverse problems represent important applications where the computational efficiency of the framework provides significant advantages. The rapid evaluation of option prices enables the use of gradient-based optimization algorithms for fitting model parameters to market data. The spectral approach’s high accuracy is particularly valuable in this context, as parameter estimation errors can be dominated by numerical approximation errors in less accurate pricing methods.</p>
<p>The incorporation of credit risk and counterparty risk modeling represents another frontier where the framework’s flexibility proves valuable. The modification of the risk-neutral measure to account for default possibilities requires adjustments to the underlying process dynamics and discount factors. The spectral methodology can accommodate these modifications while maintaining computational efficiency.</p>
<p>Machine learning applications present novel opportunities for enhancing the framework’s capabilities. Neural networks can be employed to learn improved transformation functions that further optimize the boundary representation for specific parameter regimes. Similarly, reinforcement learning techniques might discover superior iteration schemes or adaptive parameter selection strategies.</p>
<p>High-performance computing platforms, including GPU architectures and distributed computing systems, offer opportunities for dramatic performance enhancements. The framework’s mathematical structure is well-suited to vectorization and parallelization, enabling the exploitation of modern computational architectures. The compact memory footprint and regular computational patterns align well with the design constraints of specialized computing hardware.</p>
<p>The development of real-time risk management systems represents a primary application area where the framework’s performance characteristics provide competitive advantages. The ability to reprice large derivatives portfolios in milliseconds rather than minutes enables more sophisticated risk monitoring and hedging strategies. The framework’s accuracy ensures that risk calculations are not contaminated by numerical approximation errors.</p>
</section>
<section id="conclusion" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">12</span> Conclusion</h2>
<p>The Antares spectral collocation framework represents a comprehensive mathematical architecture that fundamentally advances the state of computational derivatives pricing. Through the innovative combination of integral equation formulations, sophisticated boundary transformations, and high-order numerical methods, the framework achieves unprecedented computational efficiency while maintaining exceptional numerical accuracy across the full spectrum of market conditions.</p>
<p>The mathematical elegance of the approach lies in its ability to transform the inherently complex free-boundary problem of American option pricing into a well-conditioned system amenable to spectral numerical methods. The careful design of transformation functions converts singular, highly non-linear boundary functions into smooth, nearly linear functions that can be accurately represented by low-order polynomials. This transformation enables the achievement of machine-precision accuracy with computational effort measured in hundreds rather than thousands or millions of floating-point operations.</p>
<p>The framework’s treatment of the double-boundary phenomenon under negative interest rates represents a particularly significant contribution to the field. The mathematical development of decoupled iteration schemes allows the independent computation of multiple exercise boundaries while preserving the computational efficiency of the single-boundary case. This capability ensures that the framework remains robust and efficient across all combinations of interest rate and dividend yield signs, a requirement that has become increasingly important in modern financial markets.</p>
<p>The theoretical foundation provided by spectral approximation theory guarantees exponential convergence rates that dramatically outperform traditional numerical methods. This mathematical guarantee, combined with extensive empirical validation, ensures that the framework provides reliable and accurate results across challenging parameter regimes. The adaptive algorithms automatically adjust computational effort to maintain accuracy standards, providing consistent performance regardless of problem difficulty.</p>
<p>The computational architecture emphasizes modularity and extensibility, facilitating the incorporation of advanced features and alternative mathematical formulations. The separation of mathematical algorithms from computational infrastructure enables optimization for specific hardware architectures while maintaining algorithmic flexibility. The framework’s design principles ensure that future enhancements can be incorporated without disrupting existing functionality.</p>
<p>The performance characteristics of the framework enable applications that were previously impractical due to computational constraints. Real-time portfolio pricing, high-frequency risk management, and large-scale parameter calibration become feasible with execution speeds exceeding 100,000 option valuations per second. These capabilities open new possibilities for sophisticated trading strategies and risk management techniques.</p>
<p>The mathematical rigor of the framework ensures that computational results meet the accuracy standards required for financial applications. The error estimation and adaptive refinement capabilities provide real-time feedback on solution quality, while the extensive validation infrastructure ensures continued reliability across software updates and enhancements. The framework’s deterministic nature provides reproducible results that facilitate regulatory compliance and audit requirements.</p>
<p>The unified treatment of single and double boundary cases through a common mathematical framework simplifies implementation while ensuring consistency across different market regimes. The automatic detection and handling of boundary topology changes eliminates the need for manual intervention or separate code paths, reducing the potential for implementation errors and simplifying system maintenance.</p>
<p>The Antares framework thus provides a complete solution to the American option pricing problem that meets the demanding requirements of modern financial applications. The combination of mathematical sophistication, computational efficiency, and implementation robustness establishes a new standard for derivatives pricing systems. The framework’s extensibility ensures that it can evolve to meet future market needs while maintaining its fundamental performance and accuracy advantages.</p>
<p>The success of the spectral collocation approach in the American option context suggests broader applications to other free-boundary problems in finance and related fields. The mathematical techniques developed for boundary transformation and spectral representation may prove valuable for optimal stopping problems in energy markets, real options valuation, and credit risk modeling. The computational methodologies may find applications in other areas of scientific computing where high accuracy and efficiency are paramount.</p>
<p>This comprehensive mathematical framework thus represents not merely an incremental improvement in derivatives pricing technology, but a fundamental advancement that reshapes the computational landscape for complex financial problems. The Antares system stands as a testament to the power of combining deep mathematical insight with sophisticated computational techniques to solve challenging real-world problems with unprecedented efficiency and accuracy.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<script src="Antares_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>